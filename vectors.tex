\chapter{Test vectors}

\arraycolsep=1pt

\Warning[Todo]{Fixa så det här blir fint}
A.1 Expansion of a 128-bit Cipher Key
This section contains the key expansion of the following cipher key:

Cipher Key = 2b 7e 15 16 28 ae d2 a6 ab f7 15 88 09 cf 4f 3c

for Nk = 4, which results in 
w0 = 2b7e1516 
w1 = 28aed2a6 
w2 = abf71588 
w3 = 09cf4f3ci

\begin{figure}[h]
  \centering
  \begin{array}{| c | c | c | c | c | c | c | c |}
    \hline
    &  & After & After &  & After \oplus &  & w[i] = \\
    i(dec) & temp & RotWord & SubWord & Rcon(i) & with Rcon & w[i-Nk] & temp 
    \oplus w[i-Nk] \\ \hline
    4 & 09cf4f3c & cf4f3c09 & 8a84eb01 & 01000000 & 8b84eb01 & 2b7e1516 & 
    a0fafe17 \\ \hline
    5 & a0fafe17 & & & & & 28aed2a6 & 88542cb1 \\ \hline
    6 & 88542cb1 & & & & & abf71588 & 23a33939 \\ \hline
    7 & 23a33939 & & & & & 09cf4f3c & 2a6c7605 \\ \hline
    8 & 2a6c7605 & 6c76052a & 50386be5 & 02000000 & 52386be5 & a0fafe17 & 
    f2c295f2 \\ \hline
    9 & f2c295f2 & & & & & 88542cb1 & 7a96b943 \\ \hline
    10 & 7a96b943 & & & & & 23a33939 & 5935807a \\ \hline
    11 & 5935807a & & & & & 2a6c7605 & 7359f67f \\ \hline
    12 & 7359f67f & 59f67f73 & cb42d28f & 04000000 & cf42d28f & f2c295f2 & 
    3d80477d \\ \hline
    13 & 3d80477d & & & & & 7a96b943 & 4716fe3e \\ \hline
    14 & 4716fe3e & & & & & 5935807a & 1e237e44 \\ \hline
    15 & 1e237e44 & & & & & 7359f67f & 6d7a883b \\ \hline
    16 & 6d7a883b & 7a883b6d & dac4e23c & 08000000 & d2c4e23c & 3d80477d &
    ef44a541 \\ \hline
    17 & ef44a541 & & & & & 4716fe3e & a8525b7f \\ \hline
    18 & a8525b7f & & & & & 1e237e44 & b671253b \\ \hline
    19 & b671253b & & & & & 6d7a883b & db0bad00 \\ \hline
    20 & db0bad00 & 0bad00db & 2b9563b9 & 10000000 & 3b9563b9 & ef44a541 & 
    d4d1c6f8 \\ \hline
    21 & d4d1c6f8 & & & & & a8525b7f & 7c839d87 \\ \hline
    22 & 7c839d87 & & & & & b671253b & caf2b8bc \\ \hline
    23 & caf2b8bc & & & & & db0bad00 & 11f915bc \\ \hline
    24 & 11f915bc & f915bc11 & 99596582 & 20000000 & b9596582 & d4d1c6f8 & 
    6d88a37a \\ \hline
    25 & 6d88a37a & & & & & 7c839d87 & 110b3efd \\ \hline
    26 & 110b3efd & & & & & caf2b8bc & dbf98641 \\ \hline
    27 & dbf98641 & & & & & 11f915bc & ca0093fd \\ \hline
    28 & ca0093fd & 0093fdca & 63dc5474 & 40000000 & 23dc5474 & 6d88a37a &
    4e54f70e \\ \hline
    29 & 4e54f70e & & & & & 110b3efd & 5f5fc9f3 \\ \hline
    30 & 5f5fc9f3 & & & & & dbf98641 & 84a64fb2 \\ \hline
    31 & 84a64fb2 & & & & & ca0093fd & 4ea6dc4f \\ \hline
    32 & 4ea6dc4f & a6dc4f4e & 2486842f & 80000000 & a486842f & 4e54f70e & 
    ead27321 \\ \hline
    33 & ead27321 & & & & & 5f5fc9f3 & b58dbad2 \\ \hline
    34 & b58dbad2 & & & & & 84a64fb2 & 312bf560 \\ \hline
    35 & 312bf560 & & & & & 4ea6dc4f & 7f8d292f \\ \hline
    36 & 7f8d292f & 8d292f7f & 5da515d2 & 1b000000 & 46a515d2 & ead27321 & 
    ac7766f3 \\ \hline
    37 & ac7766f3 & & & & & b58dbad2 & 19fadc21 \\ \hline
    38 & 19fadc21 & & & & & 312bf560 & 28d12941 \\ \hline
    39 & 28d12941 & & & & & 7f8d292f & 575c006e \\ \hline
    40 & 575c006e & 5c006e57 & 4a639f5b & 36000000 & 7c639f5b & ac7766f3 &
    d014f9a8 \\ \hline
    41 & d014f9a8 & & & & & 19fadc21 & c9ee2589 \\ \hline
    42 & c9ee2589 & & & & & 28d12941 & e13f0cc8 \\ \hline
    43 & e13f0cc8 & & & & & 575c006e & b6630ca6 \\ \hline
  \end{array}
\end{figure}



Test vector taken from \citet[pp. 35--36]{AES:2001}. \\
AES-128 (Nk=4, Nr=10) \\
\begin{tabbing}
  \hspace*{3cm}\=\hspace*{3cm}\= \kill
  PLAINTEXT: \> 00112233445566778899AABBCCDDEEFF \\
  KEY: \> 000102030405060708090A0B0C0D0E0F \\
\end{tabbing}

\begin{tabbing}
  \hspace*{3cm}\=\hspace*{3cm}\= \kill
  CIPHER (ENCRYPT): \\
  round[0].input \> 00112233445566778899AABBCCDDEEFF \\
  round[0].k\_sch \> 000102030405060708090A0B0C0D0E0F \\
  round[1].start \> 00102030405060708090A0B0C0D0E0F0 \\
  round[1].s\_box \> 63CAB7040953D051CD60E0E7BA70E18C \\
  round[1].s\_row \> 6353E08C0960E104CD70B751BACAD0E7 \\
  round[1].m\_col \> 5F72641557F5BC92F7BE3B291DB9F91A \\
  round[1].k\_sch \> D6AA74FDD2AF72FADAA678F1D6AB76FE \\
  round[2].start \> 89D810E8855ACE682D1843D8CB128FE4 \\
  round[2].s\_box \> A761CA9B97BE8B45D8AD1A611FC97369 \\
  round[2].s\_row \> A7BE1A6997AD739BD8C9CA451F618B61 \\
  round[2].m\_col \> FF87968431D86A51645151FA773AD009 \\
  round[2].k\_sch \> B692CF0B643DBDF1BE9BC5006830B3FE \\
  round[3].start \> 4915598F55E5D7A0DACA94FA1F0A63F7 \\
  round[3].s\_box \> 3B59CB73FCD90EE05774222DC067FB68 \\
  round[3].s\_row \> 3BD92268FC74FB735767CBE0C0590E2D \\
  round[3].m\_col \> 4C9C1E66F771F0762C3F868E534DF256 \\
  round[3].k\_sch \> B6FF744ED2C2C9BF6C590CBF0469BF41 \\
  round[4].start \> FA636A2825B339C940668A3157244D17 \\
  round[4].s\_box \> 2DFB02343F6D12DD09337EC75B36E3F0 \\
  round[4].s\_row \> 2D6D7EF03F33E334093602DD5BFB12C7 \\
  round[4].m\_col \> 6385B79FFC538DF997BE478E7547D691 \\
  round[4].k\_sch \> 47F7F7BC95353E03F96C32BCFD058DFD \\
  round[5].start \> 247240236966B3FA6ED2753288425B6C \\
  round[5].s\_box \> 36400926F9336D2D9FB59D23C42C3950 \\
  round[5].s\_row \> 36339D50F9B539269F2C092DC4406D23 \\
  round[5].m\_col \> F4BCD45432E554D075F1D6C51DD03B3C \\
  round[5].k\_sch \> 3CAAA3E8A99F9DEB50F3AF57ADF622AA \\
  round[6].start \> C81677BC9B7AC93B25027992B0261996 \\
  round[6].s\_box \> E847F56514DADDE23F77B64FE7F7D490 \\
  round[6].s\_row \> E8DAB6901477D4653FF7F5E2E747DD4F \\
  round[6].m\_col \> 9816EE7400F87F556B2C049C8E5AD036 \\
  round[6].k\_sch \> 5E390F7DF7A69296A7553DC10AA31F6B \\
  round[7].start \> C62FE109F75EEDC3CC79395D84F9CF5D \\
  round[7].s\_box \> B415F8016858552E4BB6124C5F998A4C \\
  round[7].s\_row \> B458124C68B68A014B99F82E5F15554C \\
  round[7].m\_col \> C57E1C159A9BD286F05F4BE098C63439 \\
  round[7].k\_sch \> 14F9701AE35FE28C440ADF4D4EA9C026 \\
  round[8].start \> D1876C0F79C4300AB45594ADD66FF41F \\
  round[8].s\_box \> 3E175076B61C04678DFC2295F6A8BFC0 \\
  round[8].s\_row \> 3E1C22C0B6FCBF768DA85067F6170495 \\
  round[8].m\_col \> BAA03DE7A1F9B56ED5512CBA5F414D23 \\
  round[8].k\_sch \> 47438735A41C65B9E016BAF4AEBF7AD2 \\
  round[9].start \> FDE3BAD205E5D0D73547964EF1FE37F1 \\
  round[9].s\_box \> 5411F4B56BD9700E96A0902FA1BB9AA1 \\
  round[9].s\_row \> 54D990A16BA09AB596BBF40EA111702F \\
  round[9].m\_col \> E9F74EEC023020F61BF2CCF2353C21C7 \\
  round[9].k\_sch \> 549932D1F08557681093ED9CBE2C974E \\
  round[10].start \> BD6E7C3DF2B5779E0B61216E8B10B689 \\
  round[10].s\_box \> 7A9F102789D5F50B2BEFFD9F3DCA4EA7 \\
  round[10].s\_row \> 7AD5FDA789EF4E272BCA100B3D9FF59F \\
  round[10].k\_sch \> 13111D7FE3944A17F307A78B4D2B30C5 \\
  round[10].output \> 69C4E0D86A7B0430D8CDB78070B4C55A}
\end{tabbing}
